---
layout: post
title: "Mutt, Gmail, gdata, notify-send: A Perfect Email solution"
date: 2010-04-27
comments: false
categories:
 - mutt
 - goobook
 - gdata
 - email
 - notify-send
 - gmail
 - growlnotify
---

<div class='post'>
Ever since I started working on my own, GMail has become my primary email account. I was mostly satisfied with the default web interface. However, the heavy javascript interface takes eternity to load on my slow network. The basic HTML interface is slim but doesn't have keyboard shortcuts, so it's useless. Moreover recently I found the GMail tab hogging most amount of memory in Chrome task manager. That gave me the final push to switch to a local email client.<br /><br />I have used Thunderbird and Evolution in the past, but they are not light weight by any means. I had tried Mutt before, but left it because I didn't get hang of all its shortcuts. Nonetheless I decided to give Mutt another try.<br /><br />Here are my basic requirements from the email setup:<br />1. <i>Light weight</i> - Should launch quickly when I want to check the mail. Should do only the bare minimum network I/O required to fetch new messages.<br />2. <i>Notifications</i> - Should check the mailbox at regular intervals and notify me using desktop's default notification system.<br />3. Access to <i>GMail contacts</i><br />4. Ability to Archive messages or move them to other <i>GMail folders</i>.<br /><br />So far I have figured out how to do all of the above and then some. So here are my solutions numbered same as corresponding requirements above.<br /><br />1. Setting up GMail IMAP has become significantly easy. All you have to do it create a .muttrc file in your home directory and start mutt. A simple google <a href="http://www.google.com/search?sourceid=chrome&amp;ie=UTF-8&amp;q=Mutt+Gmail+imap&amp;qscrl=1">search</a> will tell you what to put in that file. As you kick off mutt from command line, it will fetch the contents of your gmail inbox seamlessly (except if you've skipped the password in .muttrc, then it will ask you to enter it).<br /><br />2. Mutt does not support notifications. Apparently it doesn't fit into the design philosophy of its developers. But a brave soul has created a <a href="http://mndrix.blogspot.com/2005/11/notification-when-mutt-receives-new.html">patch</a> if you are interested in building your custom mutt. As for me, I didn't go that route. I setup an alternate script that uses GMail's gdata interface to check the new messages and delievers the alerts using notify-send (on my linux box) or growlnotify (on my Mac OSX). I took a simple script from <a href="http://www.imath.kiev.ua/~mellit/python/gmailatom.py">here</a> and added my modifications. You can get my version <a href="http://code.google.com/p/altcanvas/source/browse/trunk/scripts/chkgmail">here</a>. It reads the username and password from your .muttrc files. It does some rudimentary checks to find if it's on Linux or Mac OSX and accordingly calls notify-send or growlnotify; you might have to tweak the paths to suite your system.<br />[Now that I searched for it, I found many easy to use <a href="http://techcityinc.com/2009/02/08/top-5-gmail-notifiers-for-linux-2/">solutions</a>&nbsp;for notifications. Nonetheless I enjoyed writing the script, so that's a plus for me.]<br /><br />3. There is one straight forward solution for accessing GMail contacts from mutt - <a href="http://pypi.python.org/pypi/goobook/1.3a1">Goobook</a>. It also uses the gdata interface, but it is a well packaged pypi project and once installed all you need to do is put&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">set query_command = "goobook query '%s'" <span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">in your .muttrc.</span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">4. If you delete messages from mutt, they are archived on your GMail server after you sync (keyboard shortcut $). GMail labels are virtual folders and they are visible from mutt as IMAP folders. Just press&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">c <span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">and then&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">TAB<span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">. If you want to move a message from your inbox to a specific folder, press&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">s <span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">(for save) while you are viewing the message, you will be prompted for folder to save the message to. Press&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">? <span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">to get the list of IMAP folders and choose the one you want. I guess it's not possible to apply multiple labels to a message in this setup. The way I understand it is, GMail first designed labels and when they offered IMAP support they exposed labels as virtual folders over IMAP. So for any IMAP client they are folders and a single message cannot reside in multiple folders at the same time. (I might be wrong, give a shout if you know so).</span></span></span></span></span></span></span></span></span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><br /></span></span></span></span></span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">A small tip for managing .muttrc. I use two machines a linux desktop and a Macbook with Mac OSX. I have set up both to use mutt. So instead of having duplicate copies of .muttrc, I have stored a common copy in my ~/Dropbox/config folder and I just&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">source ~/Dropbox/config/.muttrc </span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">from my&nbsp;<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">~/.muttrc<span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">.</span></span></span></span></span></span></span></span></span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><br /></span></span></span></span></span></span></span></span></span></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;">Hope you find my tips useful. If you have any of your own, feel free to put them in comments.</span></span></span></span></span></span></span></span></span></span><br /><br /><i><span class="Apple-style-span" style="color: #666666;">Ads:</span></i><br />*&nbsp;<a href="http://www.amazon.com/Taming-Email-Beast-Randall-Dean/dp/0977202550?ie=UTF8&amp;tag=myfreq-20&amp;link_code=btl&amp;camp=213689&amp;creative=392969" target="_blank">Taming The Email Beast</a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=myfreq-20&amp;l=btl&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0977202550" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><br />*&nbsp;<a href="http://www.amazon.com/Linux-Administration-Handbook-2nd-Nemeth/dp/0131480049?ie=UTF8&amp;tag=myfreq-20&amp;link_code=btl&amp;camp=213689&amp;creative=392969" target="_blank">Linux Administration Handbook (2nd Edition)</a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=myfreq-20&amp;l=btl&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0131480049" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><br />*&nbsp;<a href="http://www.amazon.com/Unix-Linux-System-Administration-Handbook/dp/0131480057?ie=UTF8&amp;tag=myfreq-20&amp;link_code=btl&amp;camp=213689&amp;creative=392969" target="_blank">Unix and Linux System Administration Handbook (4th Edition)</a><img alt="" border="0" height="1" src="http://www.assoc-amazon.com/e/ir?t=myfreq-20&amp;l=btl&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0131480057" style="border: none !important; margin: 0px !important; padding: 0px !important;" width="1" /><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Times New Roman'; white-space: normal;"><br /></span></span></span></span></span></span></span></span></span></span></div>
